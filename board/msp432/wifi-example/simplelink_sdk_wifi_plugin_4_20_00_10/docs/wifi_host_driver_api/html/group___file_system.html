<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<title>SimpleLink CC31xx/CC32xx Host Driver: FileSystem</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="slgen.css" rel="stylesheet" type="text/css"/>
<link href="slnavtree.css" rel="stylesheet" type="text/css"/>
<link href="sltabs.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="4" cellpadding="4">
 <tbody>
 <tr>
  <td id="projectlogo"><img alt="Logo" src="ti_logo.png" height="50px" /></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">SimpleLink CC31xx/CC32xx Host Driver
   &#160;<span id="projectnumber">Version&#160;3.0.1.65</span>
   </div>
   <div id="projectbrief">Simplifies the implementation of Internet connectivity</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___file_system.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#enum-members">Enumerations</a>  </div>
  <div class="headertitle">
<div class="title">FileSystem</div>  </div>
</div><!--header-->
<div class="contents">

<p>Provides file system capabilities to TI's CC31XX that can be used by both the CC31XX device and the user.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga16186e069ba1bcdc6eef2ab589a42a78"><td class="memItemLeft" align="right" valign="top">_i32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___file_system.html#ga16186e069ba1bcdc6eef2ab589a42a78">sl_FsOpen</a> (const _u8 *pFileName, const _u32 AccessModeAndMaxSize, _u32 *pToken)</td></tr>
<tr class="memdesc:ga16186e069ba1bcdc6eef2ab589a42a78"><td class="mdescLeft">&#160;</td><td class="mdescRight">open file for read or write from/to storage device  <a href="#ga16186e069ba1bcdc6eef2ab589a42a78">More...</a><br /></td></tr>
<tr class="separator:ga16186e069ba1bcdc6eef2ab589a42a78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga12caded07ff4c66e5b6e73a36009072d"><td class="memItemLeft" align="right" valign="top">_i16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___file_system.html#ga12caded07ff4c66e5b6e73a36009072d">sl_FsClose</a> (const _i32 FileHdl, const _u8 *pCeritificateFileName, const _u8 *pSignature, const _u32 SignatureLen)</td></tr>
<tr class="memdesc:ga12caded07ff4c66e5b6e73a36009072d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close file in storage device.  <a href="#ga12caded07ff4c66e5b6e73a36009072d">More...</a><br /></td></tr>
<tr class="separator:ga12caded07ff4c66e5b6e73a36009072d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga745742b9829a05e2a502efa054f4900c"><td class="memItemLeft" align="right" valign="top">_i32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___file_system.html#ga745742b9829a05e2a502efa054f4900c">sl_FsRead</a> (const _i32 FileHdl, _u32 Offset, _u8 *pData, _u32 Len)</td></tr>
<tr class="memdesc:ga745742b9829a05e2a502efa054f4900c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read block of data from a file in storage device.  <a href="#ga745742b9829a05e2a502efa054f4900c">More...</a><br /></td></tr>
<tr class="separator:ga745742b9829a05e2a502efa054f4900c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23d68a0f564436b6ef08325b1a159e85"><td class="memItemLeft" align="right" valign="top">_i32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___file_system.html#ga23d68a0f564436b6ef08325b1a159e85">sl_FsWrite</a> (const _i32 FileHdl, _u32 Offset, _u8 *pData, _u32 Len)</td></tr>
<tr class="memdesc:ga23d68a0f564436b6ef08325b1a159e85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write block of data to a file in storage device.  <a href="#ga23d68a0f564436b6ef08325b1a159e85">More...</a><br /></td></tr>
<tr class="separator:ga23d68a0f564436b6ef08325b1a159e85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6df7dfcefa195a2bc5ef81dbbcaab5ed"><td class="memItemLeft" align="right" valign="top">_i16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___file_system.html#ga6df7dfcefa195a2bc5ef81dbbcaab5ed">sl_FsGetInfo</a> (const _u8 *pFileName, const _u32 Token, <a class="el" href="group___file_system.html#struct_sl_fs_file_info__t">SlFsFileInfo_t</a> *pFsFileInfo)</td></tr>
<tr class="memdesc:ga6df7dfcefa195a2bc5ef81dbbcaab5ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get information of a file.  <a href="#ga6df7dfcefa195a2bc5ef81dbbcaab5ed">More...</a><br /></td></tr>
<tr class="separator:ga6df7dfcefa195a2bc5ef81dbbcaab5ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa3b9c7b7c0e2be74332d136b94f7940d"><td class="memItemLeft" align="right" valign="top">_i16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___file_system.html#gaa3b9c7b7c0e2be74332d136b94f7940d">sl_FsDel</a> (const _u8 *pFileName, const _u32 Token)</td></tr>
<tr class="memdesc:gaa3b9c7b7c0e2be74332d136b94f7940d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete specific file from a storage or all files from a storage (format)  <a href="#gaa3b9c7b7c0e2be74332d136b94f7940d">More...</a><br /></td></tr>
<tr class="separator:gaa3b9c7b7c0e2be74332d136b94f7940d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7d225e00fe196076944ba2c768b73ed1"><td class="memItemLeft" align="right" valign="top">_i32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___file_system.html#ga7d225e00fe196076944ba2c768b73ed1">sl_FsCtl</a> (SlFsCtl_e Command, _u32 Token, _u8 *pFileName, const _u8 *pData, _u16 DataLen, _u8 *pOutputData, _u16 OutputDataLen, _u32 *pNewToken)</td></tr>
<tr class="memdesc:ga7d225e00fe196076944ba2c768b73ed1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Controls various file system operations.  <a href="#ga7d225e00fe196076944ba2c768b73ed1">More...</a><br /></td></tr>
<tr class="separator:ga7d225e00fe196076944ba2c768b73ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga726fe9fb226af88bc504996e2a59a246"><td class="memItemLeft" align="right" valign="top">_i32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___file_system.html#ga726fe9fb226af88bc504996e2a59a246">sl_FsProgram</a> (const _u8 *pData, _u16 Len, const _u8 *pKey, _u32 Flags)</td></tr>
<tr class="memdesc:ga726fe9fb226af88bc504996e2a59a246"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables to format and configure the device with pre-prepared configuration.  <a href="#ga726fe9fb226af88bc504996e2a59a246">More...</a><br /></td></tr>
<tr class="separator:ga726fe9fb226af88bc504996e2a59a246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa119b90187182eca2aeee2b5f5d17625"><td class="memItemLeft" align="right" valign="top">_i32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___file_system.html#gaa119b90187182eca2aeee2b5f5d17625">sl_FsGetFileList</a> (_i32 *pIndex, _u8 Count, _u8 MaxEntryLen, _u8 *pBuff, SlFileListFlags_t Flags)</td></tr>
<tr class="memdesc:gaa119b90187182eca2aeee2b5f5d17625"><td class="mdescLeft">&#160;</td><td class="mdescRight">The list of file names, the files are retrieve in chunks.  <a href="#gaa119b90187182eca2aeee2b5f5d17625">More...</a><br /></td></tr>
<tr class="separator:gaa119b90187182eca2aeee2b5f5d17625"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga143ddfd025c5a38c1a8410bd31ace7a9"><td class="memItemLeft" align="right" valign="top"><a id="ga143ddfd025c5a38c1a8410bd31ace7a9"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>SlFsTokenId_e</b> { <br />
&#160;&#160;<b>SL_FS_TOKEN_MASTER</b> = 0, 
<br />
&#160;&#160;<b>SL_FS_TOKEN_WRITE_READ</b> = 1, 
<br />
&#160;&#160;<b>SL_FS_TOKEN_WRITE_ONLY</b> = 2, 
<br />
&#160;&#160;<b>SL_FS_TOKEN_READ_ONLY</b> = 3
<br />
 }</td></tr>
<tr class="separator:ga143ddfd025c5a38c1a8410bd31ace7a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5d5cae2af33f10bc0be196506a0eff59"><td class="memItemLeft" align="right" valign="top"><a id="ga5d5cae2af33f10bc0be196506a0eff59"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>SlFsCtl_e</b> { <br />
&#160;&#160;<b>SL_FS_CTL_RESTORE</b> = 0, 
<br />
&#160;&#160;<b>SL_FS_CTL_ROLLBACK</b> = 1, 
<br />
&#160;&#160;<b>SL_FS_CTL_COMMIT</b> = 2, 
<br />
&#160;&#160;<b>SL_FS_CTL_RENAME</b> = 3, 
<br />
&#160;&#160;<b>SL_FS_CTL_GET_STORAGE_INFO</b> = 5, 
<br />
&#160;&#160;<b>SL_FS_CTL_BUNDLE_ROLLBACK</b> = 6, 
<br />
&#160;&#160;<b>SL_FS_CTL_BUNDLE_COMMIT</b> = 7
<br />
 }</td></tr>
<tr class="separator:ga5d5cae2af33f10bc0be196506a0eff59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga21a434e930a34cea87e01fb96a0d1f94"><td class="memItemLeft" align="right" valign="top"><a id="ga21a434e930a34cea87e01fb96a0d1f94"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>SlFsBundleState_e</b> { <br />
&#160;&#160;<b>SL_FS_BUNDLE_STATE_STOPPED</b> = 0, 
<br />
&#160;&#160;<b>SL_FS_BUNDLE_STATE_STARTED</b> = 1, 
<br />
&#160;&#160;<b>SL_FS_BUNDLE_STATE_PENDING_COMMIT</b> = 3
<br />
 }</td></tr>
<tr class="separator:ga21a434e930a34cea87e01fb96a0d1f94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga141d379c578d0988caa12fd7fff924a3"><td class="memItemLeft" align="right" valign="top"><a id="ga141d379c578d0988caa12fd7fff924a3"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>SlFsRetToFactoryOper_e</b> { <br />
&#160;&#160;<b>SL_FS_FACTORY_RET_TO_IMAGE</b> = 0, 
<br />
&#160;&#160;<b>SL_FS_FACTORY_RET_TO_DEFAULT</b> = 2
<br />
 }</td></tr>
<tr class="separator:ga141d379c578d0988caa12fd7fff924a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6bcb55d7fca7f99e285d686bb15d8198"><td class="memItemLeft" align="right" valign="top"><a id="ga6bcb55d7fca7f99e285d686bb15d8198"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>SlFileListFlags_t</b> { <b>SL_FS_GET_FILE_ATTRIBUTES</b> = 0x1
 }</td></tr>
<tr class="separator:ga6bcb55d7fca7f99e285d686bb15d8198"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Provides file system capabilities to TI's CC31XX that can be used by both the CC31XX device and the user. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga12caded07ff4c66e5b6e73a36009072d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga12caded07ff4c66e5b6e73a36009072d">&sect;&nbsp;</a></span>sl_FsClose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_i16 sl_FsClose </td>
          <td>(</td>
          <td class="paramtype">const _i32&#160;</td>
          <td class="paramname"><em>FileHdl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _u8 *&#160;</td>
          <td class="paramname"><em>pCeritificateFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _u8 *&#160;</td>
          <td class="paramname"><em>pSignature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _u32&#160;</td>
          <td class="paramname"><em>SignatureLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close file in storage device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">FileHdl</td><td>Pointer to the file (assigned from sl_FsOpen) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pCeritificateFileName</td><td>Certificate file, or NULL if irrelevant. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSignature</td><td>The signature is either SHA-1 or SHA-256, the certificate chain may include SHA-256 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SignatureLen</td><td>The signature actual length</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero on success, or a negative value if an error occurred </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group___file_system.html#ga745742b9829a05e2a502efa054f4900c" title="Read block of data from a file in storage device. ">sl_FsRead</a> <a class="el" href="group___file_system.html#ga23d68a0f564436b6ef08325b1a159e85" title="Write block of data to a file in storage device. ">sl_FsWrite</a> <a class="el" href="group___file_system.html#ga16186e069ba1bcdc6eef2ab589a42a78" title="open file for read or write from/to storage device ">sl_FsOpen</a> </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Call the fs_Close with signature = 'A' signature len = 1 for activating an abort action<br />
 Creating signature : OpenSSL&gt; dgst -binary -sha1 -sign &lt;file-location&gt;&lt;private_key&gt;.pem -out &lt;file-location&gt;&lt;output&gt;.sig &lt;file-location&gt;&lt;input&gt;.txt </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd></dd></dl>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<ul>
<li>Closing file: <div class="fragment"><div class="line">_i16 RetVal;</div><div class="line">RetVal = <a class="code" href="group___file_system.html#ga12caded07ff4c66e5b6e73a36009072d">sl_FsClose</a>(FileHandle,0,0,0);</div></div><!-- fragment --> <br />
</li>
<li>Aborting file: <div class="fragment"><div class="line">_u8  Signature;</div><div class="line">Signature = <span class="charliteral">&#39;A&#39;</span>;</div><div class="line"><a class="code" href="group___file_system.html#ga12caded07ff4c66e5b6e73a36009072d">sl_FsClose</a>(FileHandle,0,&amp;Signature, 1);</div></div><!-- fragment --></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>In case the file was opened as not secure file or as secure-not signed, any certificate or signature provided are ignored, those fields should be set to NULL. </dd></dl>

<p>Definition at line <a class="el" href="fs_8c_source.html#l00250">250</a> of file <a class="el" href="fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    _SlFsCloseMsg_u    Msg;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>        ExtCtrl;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    _SlDrvMemZero(&amp;Msg, (_u16)<span class="keyword">sizeof</span>(<a class="code" href="struct_sl_fs_close_command__t.html">SlFsCloseCommand_t</a>));</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">/* verify that this api is allowed. if not allowed then</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">    ignore the API execution and return immediately with an error */</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    VERIFY_API_ALLOWED(SL_OPCODE_SILO_FS);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    Msg.Cmd.FileHandle             = (_u32)FileHdl;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span>( pCeritificateFileName != NULL )</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        Msg.Cmd.CertificFileNameLength = (_u32)((_SlFsStrlen(pCeritificateFileName)+4) &amp; (~3)); <span class="comment">/* add 4: 1 for NULL and the 3 for align */</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    Msg.Cmd.SignatureLen           = SignatureLen;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    _SlDrvMemZero(&amp;ExtCtrl, (_u16)<span class="keyword">sizeof</span>(<a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>));</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    ExtCtrl.TxPayload1Len = (_u16)(((SignatureLen+3) &amp; (~3))); <span class="comment">/* align */</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    ExtCtrl.pTxPayload1   = (_u8*)pSignature;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    ExtCtrl.RxPayloadLen  = (_i16)Msg.Cmd.CertificFileNameLength;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    ExtCtrl.pRxPayload    = (_u8*)pCeritificateFileName; <span class="comment">/* Add signature */</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span>(ExtCtrl.pRxPayload != NULL &amp;&amp;  ExtCtrl.RxPayloadLen != 0)</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;       ExtCtrl.RxPayloadLen = ExtCtrl.RxPayloadLen * (-1);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    VERIFY_RET_OK(_SlDrvCmdOp((<a class="code" href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a> *)&amp;_SlFsCloseCmdCtrl, &amp;Msg, &amp;ExtCtrl));</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span> (_i16)((_i16)Msg.Rsp.status);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="ttc" id="struct___sl_cmd_ctrl__t_html"><div class="ttname"><a href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00210">driver.h:210</a></div></div>
<div class="ttc" id="struct_sl_fs_close_command__t_html"><div class="ttname"><a href="struct_sl_fs_close_command__t.html">SlFsCloseCommand_t</a></div><div class="ttdef"><b>Definition:</b> <a href="protocol_8h_source.html#l01180">protocol.h:1180</a></div></div>
<div class="ttc" id="struct___sl_cmd_ext__t_html"><div class="ttname"><a href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00217">driver.h:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga7d225e00fe196076944ba2c768b73ed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7d225e00fe196076944ba2c768b73ed1">&sect;&nbsp;</a></span>sl_FsCtl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_i32 sl_FsCtl </td>
          <td>(</td>
          <td class="paramtype">SlFsCtl_e&#160;</td>
          <td class="paramname"><em>Command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u32&#160;</td>
          <td class="paramname"><em>Token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u8 *&#160;</td>
          <td class="paramname"><em>pFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _u8 *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u16&#160;</td>
          <td class="paramname"><em>DataLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u8 *&#160;</td>
          <td class="paramname"><em>pOutputData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u16&#160;</td>
          <td class="paramname"><em>OutputDataLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u32 *&#160;</td>
          <td class="paramname"><em>pNewToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Controls various file system operations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Command,the</td><td>command to execute, </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>SlFsCtl_e SL_FS_CTL_RESTORE , Return to factory default, return to factory image , see fs programming SL_FS_CTL_ROLLBACK , Roll-back file which was created with 'SL_FS_WRITE_MUST_COMMIT' SL_FS_CTL_COMMIT,Commit file which was created with 'SL_FS_WRITE_MUST_COMMIT' SL_FS_CTL_RENAME, Rename file SL_FS_CTL_GET_STORAGE_INFO, Total size of storage , available size of storage SL_FS_CTL_BUNDLE_ROLLBACK, Rollback bundle files SL_FS_CTL_BUNDLE_COMMIT, Commit Bundle files </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Token</td><td>Set to NULL if not relevant to the command </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pFileName</td><td>Set to NULL if not relevant to the command </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pData</td><td>The data according the command. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataLen</td><td>Length of data buffer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pOutputData</td><td>Buffer for the output data </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">OutputDataLen</td><td>Length of the output data buffer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pNewToken</td><td>The new valid file token, if irrelevant can be set to NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>Zero on success, or a negative value if an error occurred</li>
<li>For SL_FS_CTL_BUNDLE_ROLLBACK, On success bundle the new bundle state is returned (see SlFsBundleState_e) else negative error number</li>
<li>For SL_FS_CTL_BUNDLE_COMMIT, On success the new bundle state is returned (see SlFsBundleState_e) else negative error number</li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>belongs to ext_api </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd></dd></dl>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<ul>
<li>SL_FS_CTL_ROLLBACK: <div class="fragment"><div class="line">FsControl.IncludeFilters = 0;</div><div class="line">slRetVal = <a class="code" href="group___file_system.html#ga7d225e00fe196076944ba2c768b73ed1">sl_FsCtl</a>( (SlFsCtl_e)SL_FS_CTL_FILE_ROLLBACK, Token, NWPfileName ,(_u8 *)&amp;FsControl, <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_fs_control__t">SlFsControl_t</a>), NULL, 0 , pNewToken);</div></div><!-- fragment --> <br />
</li>
<li>SL_FS_CTL_COMMIT: <div class="fragment"><div class="line">FsControl.IncludeFilters = 0;</div><div class="line">slRetVal = <a class="code" href="group___file_system.html#ga7d225e00fe196076944ba2c768b73ed1">sl_FsCtl</a>(SL_FS_CTL_COMMIT, Token, NWPfileName ,(_u8 *)&amp;FsControl, <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_fs_control__t">SlFsControl_t</a>), NULL, 0, pNewToken );</div></div><!-- fragment --> <br />
</li>
<li>SL_FS_CTL_RENAME: <div class="fragment"><div class="line">slRetVal = <a class="code" href="group___file_system.html#ga7d225e00fe196076944ba2c768b73ed1">sl_FsCtl</a>(SL_FS_CTL_RENAME, Token, NWPfileName, NewFileName, 0, NULL, 0, NULL );</div></div><!-- fragment --> <br />
</li>
<li>SL_FS_CTL_GET_STORAGE_INFO: <div class="fragment"><div class="line">_i32  GetStorageInfo( <a class="code" href="group___file_system.html#struct_sl_fs_control_get_storage_info_response__t">SlFsControlGetStorageInfoResponse_t</a>* pSlFsControlGetStorageInfoResponse )</div><div class="line">{</div><div class="line">    _i32 slRetVal;</div><div class="line"></div><div class="line">    slRetVal = <a class="code" href="group___file_system.html#ga7d225e00fe196076944ba2c768b73ed1">sl_FsCtl</a>( ( SlFsCtl_e)SL_FS_CTL_GET_STORAGE_INFO, 0, NULL , NULL , 0, (_u8 *)pSlFsControlGetStorageInfoResponse, <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_fs_control_get_storage_info_response__t">SlFsControlGetStorageInfoResponse_t</a>), NULL );</div><div class="line">    <span class="keywordflow">return</span> slRetVal;</div><div class="line">}</div></div><!-- fragment --> <br />
</li>
<li>SL_FS_CTL_RESTORE: <div class="fragment"><div class="line"><span class="comment">//Return 0 for OK, else Error</span></div><div class="line">_i32 ProgramRetToImage( )</div><div class="line">{</div><div class="line">    _i32 slRetVal;</div><div class="line">    <a class="code" href="group___file_system.html#struct_sl_fs_ret_to_factory_command__t">SlFsRetToFactoryCommand_t</a> RetToFactoryCommand;</div><div class="line">    _i32 RetVal, ExtendedError;</div><div class="line"></div><div class="line">    RetToFactoryCommand.Operation = SL_FS_FACTORY_RET_TO_IMAGE;</div><div class="line">    slRetVal = <a class="code" href="group___file_system.html#ga7d225e00fe196076944ba2c768b73ed1">sl_FsCtl</a>( (SlFsCtl_e)SL_FS_CTL_RESTORE, 0, NULL , (_u8 *)&amp;RetToFactoryCommand , <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_fs_ret_to_factory_command__t">SlFsRetToFactoryCommand_t</a>), NULL, 0 , NULL );</div><div class="line">    <span class="keywordflow">if</span> ((_i32)slRetVal &lt; 0)</div><div class="line">        {</div><div class="line">            <span class="comment">//Pay attention, for this function the slRetVal is composed from Signed RetVal &amp; extended error</span></div><div class="line">            RetVal = (_i16)slRetVal&gt;&gt; 16;</div><div class="line">            ExtendedError = (_u16)slRetVal&amp; 0xFFFF;</div><div class="line">            printf(<span class="stringliteral">&quot;\tError SL_FS_FACTORY_RET_TO_IMAGE, 5d, %d\n&quot;</span>, RetVal, ExtendedError);</div><div class="line">            <span class="keywordflow">return</span> slRetVal;</div><div class="line">    }</div><div class="line">    <span class="comment">//Reset</span></div><div class="line">    <a class="code" href="group___device.html#gafe7d6e18cd17c10e1b2d9793af56df13">sl_Stop</a>(0);</div><div class="line">    Sleep(1000);</div><div class="line">    <a class="code" href="group___device.html#ga5869df658d2c9fe3c2baa50503a1a8dd">sl_Start</a>(NULL, NULL, NULL);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> slRetVal;</div><div class="line">}</div></div><!-- fragment --> <br />
</li>
<li>SL_FS_CTL_BUNDLE_ROLLBACK: <div class="fragment"><div class="line"><span class="comment">//return 0 for O.K else negative</span></div><div class="line">_i32 BundleRollback()</div><div class="line">{</div><div class="line">    _i32 slRetVal = 0;</div><div class="line">    <a class="code" href="group___file_system.html#struct_sl_fs_control__t">SlFsControl_t</a> FsControl;</div><div class="line">    FsControl.IncludeFilters = 0; <span class="comment">//Use default behaviour</span></div><div class="line">    slRetVal = <a class="code" href="group___file_system.html#ga7d225e00fe196076944ba2c768b73ed1">sl_FsCtl</a>( (SlFsCtl_e)SL_FS_CTL_BUNDLE_ROLLBACK, 0, NULL ,(_u8 *)&amp;FsControl, <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_fs_control__t">SlFsControl_t</a>), NULL, 0 , NULL);</div><div class="line">    <span class="keywordflow">return</span> slRetVal;</div><div class="line">}</div></div><!-- fragment --> <br />
</li>
<li>SL_FS_CTL_BUNDLE_COMMIT: <div class="fragment"><div class="line"><span class="comment">//return 0 for O.K else negative</span></div><div class="line">_i32 BundleCommit()</div><div class="line">{</div><div class="line">    _i32 slRetVal = 0;</div><div class="line">    <a class="code" href="group___file_system.html#struct_sl_fs_control__t">SlFsControl_t</a> FsControl;</div><div class="line">    FsControl.IncludeFilters = 0; <span class="comment">//Use default behaviour</span></div><div class="line">    slRetVal = <a class="code" href="group___file_system.html#ga7d225e00fe196076944ba2c768b73ed1">sl_FsCtl</a>( (SlFsCtl_e)SL_FS_CTL_BUNDLE_COMMIT, 0, NULL ,(_u8 *)&amp;FsControl, <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_fs_control__t">SlFsControl_t</a>), NULL, 0 , NULL);</div><div class="line">    <span class="keywordflow">return</span> slRetVal;</div><div class="line">}</div></div><!-- fragment --> </li>
</ul>

<p>Definition at line <a class="el" href="fs_8c_source.html#l00585">585</a> of file <a class="el" href="fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;{</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    _SlFsFileSysControlMsg_u     Msg;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>                  CmdExt;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">/* verify that this api is allowed. if not allowed then</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">    ignore the API execution and return immediately with an error */</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    VERIFY_API_ALLOWED(SL_OPCODE_SILO_FS);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    Msg.Cmd.Token = Token;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    Msg.Cmd.Operation = (_u8)Command;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    _SlDrvMemZero(&amp;CmdExt, (_u16)<span class="keyword">sizeof</span>(<a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>));</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">if</span> ((SL_FS_CTL_ROLLBACK == Command) || (SL_FS_CTL_COMMIT == Command ))</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        Msg.Cmd.FileNameLength = _SlFsStrlen(pFileName) + 1 ;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">if</span> ( _SlFsStrlen(pFileName) &gt;= SL_FS_MAX_FILE_NAME_LENGTH )</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordflow">return</span> SL_ERROR_FS_WRONG_FILE_NAME;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        }</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="comment">/*the data is aligned*/</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        CmdExt.RxPayloadLen = DataLen;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        CmdExt.pRxPayload = (_u8 *)(pData);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        CmdExt.TxPayload1Len = (_SlFsStrlen(pFileName) + 4) &amp; (~3);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        CmdExt.pTxPayload1   = pFileName;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        Msg.Cmd.BufferLength =  CmdExt.RxPayloadLen + CmdExt.TxPayload1Len;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;       <span class="keywordflow">if</span>(CmdExt.pRxPayload != NULL &amp;&amp;  CmdExt.RxPayloadLen != 0)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;       {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;           CmdExt.RxPayloadLen = CmdExt.RxPayloadLen * (-1);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;       }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( SL_FS_CTL_RENAME == Command )</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">if</span> ( _SlFsStrlen(pFileName) &gt;= SL_FS_MAX_FILE_NAME_LENGTH )</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="keywordflow">return</span> SL_ERROR_FS_WRONG_FILE_NAME;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        Msg.Cmd.FileNameLength = (_SlFsStrlen(pFileName) + 4) &amp; (~3);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="comment">/*current file name*/</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        CmdExt.RxPayloadLen = (_u16)Msg.Cmd.FileNameLength;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        CmdExt.pRxPayload   = pFileName;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="comment">/*New file name*/</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        CmdExt.TxPayload1Len = (_SlFsStrlen(pData) + 4) &amp; (~3);;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        CmdExt.pTxPayload1 = (_u8 *)(pData);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        Msg.Cmd.BufferLength =  CmdExt.RxPayloadLen + CmdExt.TxPayload1Len;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;       <span class="keywordflow">if</span>(CmdExt.pRxPayload != NULL &amp;&amp;  CmdExt.RxPayloadLen != 0)</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;       {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;           CmdExt.RxPayloadLen = CmdExt.RxPayloadLen * (-1);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;       }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        Msg.Cmd.FileNameLength = 0;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        CmdExt.TxPayload1Len = (DataLen + 3) &amp; (~3);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        CmdExt.pTxPayload1 = (_u8 *)(pData);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        CmdExt.RxPayloadLen = OutputDataLen;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        CmdExt.pRxPayload = pOutputData;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        Msg.Cmd.BufferLength =  CmdExt.TxPayload1Len;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    VERIFY_RET_OK(_SlDrvCmdOp((<a class="code" href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a> *)&amp;_SlFsFileSysControlCmdCtrl, &amp;Msg, &amp;CmdExt));</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">if</span>( pNewToken != NULL )</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        *pNewToken = Msg.Rsp.Token;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">return</span>  (_i32)((_i32)Msg.Rsp.Status);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;}</div><div class="ttc" id="struct___sl_cmd_ctrl__t_html"><div class="ttname"><a href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00210">driver.h:210</a></div></div>
<div class="ttc" id="struct___sl_cmd_ext__t_html"><div class="ttname"><a href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00217">driver.h:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaa3b9c7b7c0e2be74332d136b94f7940d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa3b9c7b7c0e2be74332d136b94f7940d">&sect;&nbsp;</a></span>sl_FsDel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_i16 sl_FsDel </td>
          <td>(</td>
          <td class="paramtype">const _u8 *&#160;</td>
          <td class="paramname"><em>pFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _u32&#160;</td>
          <td class="paramname"><em>Token</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete specific file from a storage or all files from a storage (format) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pFileName</td><td>File Name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Token</td><td>File token. if irrelevant set to 0 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero on success, or a negative value if an error occurred</dd></dl>
<dl class="section see"><dt>See also</dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>belongs to basic_api </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd></dd></dl>
<dl class="section user"><dt>Example</dt><dd></dd></dl>
<ul>
<li>Deleting file: <div class="fragment"><div class="line">Status = <a class="code" href="group___file_system.html#gaa3b9c7b7c0e2be74332d136b94f7940d">sl_FsDel</a>(<span class="stringliteral">&quot;FileName.html&quot;</span>,Token);</div></div><!-- fragment --> </li>
</ul>

<p>Definition at line <a class="el" href="fs_8c_source.html#l00541">541</a> of file <a class="el" href="fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;{</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    _SlFsDeleteMsg_u Msg;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>      CmdExt;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">/* verify that this api is allowed. if not allowed then</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">    ignore the API execution and return immediately with an error */</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    VERIFY_API_ALLOWED(SL_OPCODE_SILO_FS);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">if</span> ( _SlFsStrlen(pFileName) &gt;= SL_FS_MAX_FILE_NAME_LENGTH )</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">return</span> SL_ERROR_FS_WRONG_FILE_NAME;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    _SlDrvMemZero(&amp;CmdExt, (_u16)<span class="keyword">sizeof</span>(<a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>));</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    CmdExt.TxPayload1Len = (_u16)((_SlFsStrlen(pFileName)+4) &amp; (~3)); <span class="comment">/* add 4: 1 for NULL and the 3 for align */</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    CmdExt.pTxPayload1   = (_u8*)pFileName;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    Msg.Cmd.Token        = Token;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    VERIFY_RET_OK(_SlDrvCmdOp((<a class="code" href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a> *)&amp;_SlFsDeleteCmdCtrl, &amp;Msg, &amp;CmdExt));</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">return</span>  (_i16)((_i16)Msg.Rsp.status);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div><div class="ttc" id="struct___sl_cmd_ctrl__t_html"><div class="ttname"><a href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00210">driver.h:210</a></div></div>
<div class="ttc" id="struct___sl_cmd_ext__t_html"><div class="ttname"><a href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00217">driver.h:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gaa119b90187182eca2aeee2b5f5d17625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa119b90187182eca2aeee2b5f5d17625">&sect;&nbsp;</a></span>sl_FsGetFileList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_i32 sl_FsGetFileList </td>
          <td>(</td>
          <td class="paramtype">_i32 *&#160;</td>
          <td class="paramname"><em>pIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u8&#160;</td>
          <td class="paramname"><em>Count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u8&#160;</td>
          <td class="paramname"><em>MaxEntryLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u8 *&#160;</td>
          <td class="paramname"><em>pBuff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SlFileListFlags_t&#160;</td>
          <td class="paramname"><em>Flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The list of file names, the files are retrieve in chunks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pIndex</td><td>The first chunk should start with value of -1, afterwards the Index from the previous call should be set as input<br />
 Returns current chunk intex, start the next chunk from that number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Count</td><td>Number of entries to retrieve </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MaxEntryLen</td><td>The total size of the buffer is Count * MaxEntryLen </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pBuff</td><td>The buffer contains list of <a class="el" href="group___file_system.html#struct_sl_file_attributes__t">SlFileAttributes_t</a> + file name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Flags</td><td>Is to retrieve file attributes see <a class="el" href="group___file_system.html#struct_sl_file_attributes__t">SlFileAttributes_t</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The actual number of entries which are contained in the buffer. On error negative number which contains the error number. </dd></dl>
<dl class="section see"><dt>See also</dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>belongs to ext_api </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd></dd></dl>
<dl class="section user"><dt>Example</dt><dd></dd></dl>
<ul>
<li>Getting file list <div class="fragment"><div class="line"> <span class="keyword">typedef</span> <span class="keyword">struct</span></div><div class="line"> {</div><div class="line">     <a class="code" href="group___file_system.html#struct_sl_file_attributes__t">SlFileAttributes_t</a> attribute;</div><div class="line">     <span class="keywordtype">char</span> fileName[SL_FS_MAX_FILE_NAME_LENGTH];</div><div class="line"> }slGetfileList_t;</div><div class="line"></div><div class="line"><span class="preprocessor"> #define COUNT 5</span></div><div class="line"></div><div class="line"> <span class="keywordtype">void</span> PrintFileListProperty(_u16 prop);</div><div class="line"></div><div class="line"> INT32 GetFileList()</div><div class="line"> {</div><div class="line">     _i32 NumOfEntriesOrError = 1;</div><div class="line">     _i32 Index = -1;</div><div class="line">     slGetfileList_t File[COUNT];</div><div class="line">     _i32  i;</div><div class="line">     _i32 RetVal = 0;</div><div class="line"></div><div class="line">     printf(<span class="stringliteral">&quot;%\n&quot;</span>);</div><div class="line">     <span class="keywordflow">while</span>( NumOfEntriesOrError &gt; 0 )</div><div class="line">     {</div><div class="line">         NumOfEntriesOrError = <a class="code" href="group___file_system.html#gaa119b90187182eca2aeee2b5f5d17625">sl_FsGetFileList</a>( &amp;Index, COUNT, (_u8)(SL_FS_MAX_FILE_NAME_LENGTH + <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_file_attributes__t">SlFileAttributes_t</a>)), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)File, SL_FS_GET_FILE_ATTRIBUTES);</div><div class="line">         <span class="keywordflow">if</span> (NumOfEntriesOrError &lt; 0)</div><div class="line">         {</div><div class="line">             RetVal = NumOfEntriesOrError;<span class="comment">//error</span></div><div class="line">             <span class="keywordflow">break</span>;</div><div class="line">         }</div><div class="line">         <span class="keywordflow">for</span> (i = 0; i &lt; NumOfEntriesOrError; i++)</div><div class="line">         {</div><div class="line">            printf(<span class="stringliteral">&quot;Name: %s\n&quot;</span>, File[i].fileName);</div><div class="line">            printf(<span class="stringliteral">&quot;AllocatedBlocks: %5d &quot;</span>,File[i].attribute.FileAllocatedBlocks);</div><div class="line">            printf(<span class="stringliteral">&quot;MaxSize(byte): %5d \n&quot;</span>, File[i].attribute.FileMaxSize);</div><div class="line">            PrintFileListProperty((_u16)File[i].attribute.Properties);</div><div class="line">            printf(<span class="stringliteral">&quot;%\n\n&quot;</span>);</div><div class="line">        }</div><div class="line">    }</div><div class="line">    printf(<span class="stringliteral">&quot;%\n&quot;</span>);</div><div class="line">    <span class="keywordflow">return</span> RetVal;<span class="comment">//0 means O.K</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> PrintFileListProperty(_u16 prop)</div><div class="line">{</div><div class="line">    printf(<span class="stringliteral">&quot;Flags : &quot;</span>);</div><div class="line">    <span class="keywordflow">if</span> (prop &amp; SL_FS_INFO_MUST_COMMIT)</div><div class="line">        printf(<span class="stringliteral">&quot;Open file commit,&quot;</span>);</div><div class="line">    <span class="keywordflow">if</span> (prop &amp; SL_FS_INFO_BUNDLE_FILE)</div><div class="line">        printf(<span class="stringliteral">&quot;Open bundle commit,&quot;</span>);</div><div class="line">    <span class="keywordflow">if</span> (prop &amp; SL_FS_INFO_PENDING_COMMIT)</div><div class="line">        printf(<span class="stringliteral">&quot;Pending file commit,&quot;</span>);</div><div class="line">    <span class="keywordflow">if</span> (prop &amp; SL_FS_INFO_PENDING_BUNDLE_COMMIT)</div><div class="line">         printf(<span class="stringliteral">&quot;Pending bundle commit,&quot;</span>);</div><div class="line">     <span class="keywordflow">if</span> (prop &amp; SL_FS_INFO_SECURE)</div><div class="line">         printf(<span class="stringliteral">&quot;Secure,&quot;</span>);</div><div class="line">     <span class="keywordflow">if</span> (prop &amp; SL_FS_INFO_NOT_FAILSAFE)</div><div class="line">         printf(<span class="stringliteral">&quot;File safe,&quot;</span>);</div><div class="line">     <span class="keywordflow">if</span> (prop &amp; SL_FS_INFO_SYS_FILE)</div><div class="line">         printf(<span class="stringliteral">&quot;System,&quot;</span>);</div><div class="line">     <span class="keywordflow">if</span> (prop &amp; SL_FS_INFO_NOT_VALID)</div><div class="line">         printf(<span class="stringliteral">&quot;No valid copy,&quot;</span>);</div><div class="line">     <span class="keywordflow">if</span> (prop &amp; SL_FS_INFO_PUBLIC_WRITE)</div><div class="line">         printf(<span class="stringliteral">&quot;Public write,&quot;</span>);</div><div class="line">     <span class="keywordflow">if</span> (prop &amp; SL_FS_INFO_PUBLIC_READ)</div><div class="line">         printf(<span class="stringliteral">&quot;Public read,&quot;</span>);</div><div class="line"> }</div></div><!-- fragment --> </li>
</ul>

<p>Definition at line <a class="el" href="fs_8c_source.html#l00791">791</a> of file <a class="el" href="fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;{</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    _SlFsGetFileListMsg_u     Msg;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>               CmdExt;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    _u16                      OutputBufferSize;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="comment">/* verify that this api is allowed. if not allowed then</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">    ignore the API execution and return immediately with an error */</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    VERIFY_API_ALLOWED(SL_OPCODE_SILO_FS);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    _SlDrvResetCmdExt(&amp;CmdExt);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    Msg.Cmd.Index = *pIndex;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    Msg.Cmd.MaxEntryLen = MaxEntryLen  &amp; (~3); <span class="comment">/* round to modulu 4 */</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    Msg.Cmd.Count = Count;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    Msg.Cmd.Flags = (_u8)Flags;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    OutputBufferSize = Msg.Cmd.Count * Msg.Cmd.MaxEntryLen;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordflow">if</span>( OutputBufferSize &gt; MAX_NVMEM_CHUNK_SIZE )</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    {</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">return</span> SL_ERROR_FS_WRONG_INPUT_SIZE;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    }</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    CmdExt.RxPayloadLen = OutputBufferSize;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    CmdExt.pRxPayload   = pBuff;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    VERIFY_RET_OK(_SlDrvCmdOp((<a class="code" href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a> *)&amp;_SlFsGetFileListCmdCtrl, &amp;Msg, &amp;CmdExt));</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    *pIndex = Msg.Rsp.Index;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">return</span>  (_i32)((_i32)Msg.Rsp.NumOfEntriesOrError);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;}</div><div class="ttc" id="struct___sl_cmd_ctrl__t_html"><div class="ttname"><a href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00210">driver.h:210</a></div></div>
<div class="ttc" id="struct___sl_cmd_ext__t_html"><div class="ttname"><a href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00217">driver.h:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga6df7dfcefa195a2bc5ef81dbbcaab5ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6df7dfcefa195a2bc5ef81dbbcaab5ed">&sect;&nbsp;</a></span>sl_FsGetInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_i16 sl_FsGetInfo </td>
          <td>(</td>
          <td class="paramtype">const _u8 *&#160;</td>
          <td class="paramname"><em>pFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _u32&#160;</td>
          <td class="paramname"><em>Token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___file_system.html#struct_sl_fs_file_info__t">SlFsFileInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pFsFileInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get information of a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pFileName</td><td>File name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Token</td><td>File token. if irrelevant set to 0. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pFsFileInfo</td><td>Returns the File's Information (<a class="el" href="group___file_system.html#struct_sl_fs_file_info__t">SlFsFileInfo_t</a>)<ul>
<li>Flags</li>
<li>File size</li>
<li>Allocated size</li>
<li>Tokens</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero on success, negative error code on failure <br />
 When file not exists : SL_ERROR_FS_FILE_NOT_EXISTS </dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>If the return value is SL_ERROR_FS_FILE_HAS_NOT_BEEN_CLOSE_CORRECTLY or SL_ERROR_FS_FILE_IS_ALREADY_OPENED information about the file is valid.</li>
<li>Belongs to basic_api</li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group___file_system.html#ga16186e069ba1bcdc6eef2ab589a42a78" title="open file for read or write from/to storage device ">sl_FsOpen</a> </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd></dd></dl>
<dl class="section user"><dt>Example</dt><dd></dd></dl>
<ul>
<li>Getting file info: <div class="fragment"><div class="line">Status = <a class="code" href="group___file_system.html#ga6df7dfcefa195a2bc5ef81dbbcaab5ed">sl_FsGetInfo</a>(<span class="stringliteral">&quot;FileName.html&quot;</span>,Token,&amp;FsFileInfo);</div></div><!-- fragment --> </li>
</ul>

<p>Definition at line <a class="el" href="fs_8c_source.html#l00475">475</a> of file <a class="el" href="fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    _SlFsGetInfoMsg_u    Msg;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>          CmdExt;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    _u16                 BitNum;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">/* verify that this api is allowed. if not allowed then</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">    ignore the API execution and return immediately with an error */</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    VERIFY_API_ALLOWED(SL_OPCODE_SILO_FS);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    _SlDrvMemZero(&amp;CmdExt, (_u16)<span class="keyword">sizeof</span>(<a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>));</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> ( _SlFsStrlen(pFileName) &gt;= SL_FS_MAX_FILE_NAME_LENGTH )</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">return</span> SL_ERROR_FS_WRONG_FILE_NAME;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    CmdExt.TxPayload1Len = (_u16)((_SlFsStrlen(pFileName)+4) &amp; (~3)); <span class="comment">/* add 4: 1 for NULL and the 3 for align  */</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    CmdExt.pTxPayload1   = (_u8*)pFileName;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    Msg.Cmd.Token        = Token;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    VERIFY_RET_OK(_SlDrvCmdOp((<a class="code" href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a> *)&amp;_SlFsGetInfoCmdCtrl, &amp;Msg, &amp;CmdExt));</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">/* convert flags */</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    pFsFileInfo-&gt;Flags = 0;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">for</span> (BitNum = 0; BitNum &lt; 16; BitNum++ )</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordflow">if</span> (( Msg.Rsp.Flags &gt;&gt; BitNum) &amp; 0x1 )</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            pFsFileInfo-&gt;Flags |= FlagsTranslate[BitNum];</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    pFsFileInfo-&gt;Len          = Msg.Rsp.FileLen;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    pFsFileInfo-&gt;MaxSize      = Msg.Rsp.AllocatedLen;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    pFsFileInfo-&gt;Token[0]     = Msg.Rsp.Token[0];</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    pFsFileInfo-&gt;Token[1]     = Msg.Rsp.Token[1];</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    pFsFileInfo-&gt;Token[2]     = Msg.Rsp.Token[2];</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    pFsFileInfo-&gt;Token[3]     = Msg.Rsp.Token[3];</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    pFsFileInfo-&gt;StorageSize  = Msg.Rsp.FileStorageSize;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    pFsFileInfo-&gt;WriteCounter = Msg.Rsp.FileWriteCounter;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">return</span>  (_i16)((_i16)Msg.Rsp.Status);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div><div class="ttc" id="struct___sl_cmd_ctrl__t_html"><div class="ttname"><a href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00210">driver.h:210</a></div></div>
<div class="ttc" id="struct___sl_cmd_ext__t_html"><div class="ttname"><a href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00217">driver.h:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga16186e069ba1bcdc6eef2ab589a42a78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga16186e069ba1bcdc6eef2ab589a42a78">&sect;&nbsp;</a></span>sl_FsOpen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_i32 sl_FsOpen </td>
          <td>(</td>
          <td class="paramtype">const _u8 *&#160;</td>
          <td class="paramname"><em>pFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _u32&#160;</td>
          <td class="paramname"><em>AccessModeAndMaxSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u32 *&#160;</td>
          <td class="paramname"><em>pToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>open file for read or write from/to storage device </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pFileName</td><td>File Name buffer pointer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AccessModeAndMaxSize</td><td>Options: As described below </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pToken</td><td>input Token for read, output Token for write</td></tr>
  </table>
  </dd>
</dl>
<p>AccessModeAndMaxSize possible input <br />
 SL_FS_READ - Read a file <br />
 SL_FS_WRITE - Open for write for an existing file (whole file content needs to be rewritten)<br />
 SL_FS_CREATE|maxSizeInBytes,accessModeFlags SL_FS_CREATE|SL_FS_OVERWRITE|maxSizeInBytes,accessModeFlags - Open for creating a new file. Max file size is defined in bytes. <br />
 For optimal FS size, use max size in 4K-512 bytes steps (e.g. 3584,7680,117760) <br />
 Several access modes bits can be combined together from SlFileOpenFlags_e enum</p>
<dl class="section return"><dt>Returns</dt><dd>File handle on success. Negative error code on fail</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group___file_system.html#ga745742b9829a05e2a502efa054f4900c" title="Read block of data from a file in storage device. ">sl_FsRead</a> <a class="el" href="group___file_system.html#ga23d68a0f564436b6ef08325b1a159e85" title="Write block of data to a file in storage device. ">sl_FsWrite</a> <a class="el" href="group___file_system.html#ga12caded07ff4c66e5b6e73a36009072d" title="Close file in storage device. ">sl_FsClose</a> </dd></dl>
<dl class="section note"><dt>Note</dt><dd>belongs to basic_api </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd></dd></dl>
<dl class="section user"><dt>Example</dt><dd></dd></dl>
<ul>
<li>Creating file and writing data to it <div class="fragment"><div class="line"><span class="keywordtype">char</span>*           DeviceFileName = <span class="stringliteral">&quot;MyFile.txt&quot;</span>;</div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>   MaxSize = 63 * 1024; <span class="comment">//62.5K is max file size</span></div><div class="line"><span class="keywordtype">long</span>            DeviceFileHandle = -1;</div><div class="line">_i32            RetVal;        <span class="comment">//negative retval is an error</span></div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>   Offset = 0;</div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   InputBuffer[100];</div><div class="line">_u32            MasterToken = 0;</div><div class="line"></div><div class="line"><span class="comment">// Create a file and write data. The file in this example is secured, without signature and with a fail safe commit</span></div><div class="line"></div><div class="line"><span class="comment">//create a secure file if not exists and open it for write.</span></div><div class="line">DeviceFileHandle =  <a class="code" href="group___file_system.html#ga16186e069ba1bcdc6eef2ab589a42a78">sl_FsOpen</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)DeviceFileName,</div><div class="line">                              SL_FS_CREATE|SL_FS_OVERWRITE | SL_FS_CREATE_SECURE | SL_FS_CREATE_NOSIGNATURE | SL_FS_CREATE_MAX_SIZE( MaxSize ),</div><div class="line">                              &amp;MasterToken);</div><div class="line"></div><div class="line">Offset = 0;</div><div class="line"><span class="comment">//Preferred in secure file that the Offset and the length will be aligned to 16 bytes.</span></div><div class="line">RetVal = <a class="code" href="group___file_system.html#ga23d68a0f564436b6ef08325b1a159e85">sl_FsWrite</a>( DeviceFileHandle, Offset, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)&quot;HelloWorld&quot;, strlen(&quot;HelloWorld&quot;));</div><div class="line"></div><div class="line">RetVal = <a class="code" href="group___file_system.html#ga12caded07ff4c66e5b6e73a36009072d">sl_FsClose</a>(DeviceFileHandle, NULL, NULL , 0);</div><div class="line"></div><div class="line"><span class="comment">// open the same file for read, using the Token we got from the creation procedure above</span></div><div class="line">DeviceFileHandle =  <a class="code" href="group___file_system.html#ga16186e069ba1bcdc6eef2ab589a42a78">sl_FsOpen</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)DeviceFileName,</div><div class="line">                              SL_FS_READ,</div><div class="line">                              &amp;MasterToken);</div><div class="line"></div><div class="line">Offset = 0;</div><div class="line">RetVal = <a class="code" href="group___file_system.html#ga745742b9829a05e2a502efa054f4900c">sl_FsRead</a>( DeviceFileHandle, Offset, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)InputBuffer, strlen(&quot;HelloWorld&quot;));</div><div class="line"></div><div class="line">RetVal = <a class="code" href="group___file_system.html#ga12caded07ff4c66e5b6e73a36009072d">sl_FsClose</a>(DeviceFileHandle, NULL, NULL , 0);</div></div><!-- fragment --> <br />
</li>
<li>Create a non secure file if not already exists and open it for write <div class="fragment"><div class="line">DeviceFileHandle = <a class="code" href="group___file_system.html#ga16186e069ba1bcdc6eef2ab589a42a78">sl_FsOpen</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)DeviceFileName,</div><div class="line">                              SL_FS_CREATE|SL_FS_OVERWRITE| SL_FS_CREATE_MAX_SIZE( MaxSize ),</div><div class="line">                              NULL);</div></div><!-- fragment --></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Some of the flags are creation flags and can only be set when the file is created. When opening the file for write the creation flags are ignored. For more information, refer to chapter 8 in the user manual. </dd></dl>

<p>Definition at line <a class="el" href="fs_8c_source.html#l00157">157</a> of file <a class="el" href="fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;{</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    _SlFsOpenMsg_u        Msg;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>           CmdExt;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    _i32                  FileHandle;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    _u32                  MaxSizeInBytes;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    _u32                  OpenMode;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    _u8                   CreateMode;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">/* verify that this api is allowed. if not allowed then</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">    ignore the API execution and return immediately with an error */</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    VERIFY_API_ALLOWED(SL_OPCODE_SILO_FS);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    _SlDrvMemZero(&amp;CmdExt, (_u16)<span class="keyword">sizeof</span>(<a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>));</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> ( _SlFsStrlen(pFileName) &gt;= SL_FS_MAX_FILE_NAME_LENGTH )</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">return</span> SL_ERROR_FS_WRONG_FILE_NAME;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    CmdExt.TxPayload1Len = (_u16)((_SlFsStrlen(pFileName)+4) &amp; (~3)); <span class="comment">/* add 4: 1 for NULL and the 3 for align */</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    CmdExt.pTxPayload1 = (_u8*)pFileName;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    OpenMode = ModeAndMaxSize &amp; SL_FS_OPEN_MODE_BIT_MASK;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">/*convert from the interface flags to the device flags*/</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span>( OpenMode == SL_FS_READ )</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        Msg.Cmd.Mode = FS_MODE(FS_MODE_OPEN_READ, 0, 0, 0);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (( OpenMode == SL_FS_WRITE ) ||( OpenMode == SL_FS_OVERWRITE))</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        Msg.Cmd.Mode = FS_MODE(FS_MODE_OPEN_WRITE, 0, 0, FS_CONVERT_FLAGS ( ModeAndMaxSize));</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">/* one of the creation mode */</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ( OpenMode == (SL_FS_CREATE | SL_FS_OVERWRITE )) || ( OpenMode == SL_FS_CREATE) ||(OpenMode == (SL_FS_CREATE | SL_FS_WRITE )))</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;       <span class="comment">/* test that the size is correct */</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;       MaxSizeInBytes = (ModeAndMaxSize &amp; SL_FS_OPEN_MAXSIZE_BIT_MASK) * 256;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;       <span class="keywordflow">if</span> (MaxSizeInBytes &gt; 0xFF0000 )</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;       {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;           <span class="keywordflow">return</span> SL_ERROR_FS_FILE_MAX_SIZE_EXCEEDED;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;       }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;       CreateMode = ((OpenMode == (SL_FS_CREATE | SL_FS_OVERWRITE )) ? FS_MODE_OPEN_WRITE_CREATE_IF_NOT_EXIST : FS_MODE_OPEN_CREATE  );</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        Msg.Cmd.Mode = FsGetCreateFsMode( CreateMode ,MaxSizeInBytes, FS_CONVERT_FLAGS ( ModeAndMaxSize)  );</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">return</span> SL_ERROR_FS_INVALID_FILE_MODE;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span>(pToken != NULL)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        Msg.Cmd.Token         = *pToken;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        Msg.Cmd.Token         = 0;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    _SlDrvCmdOp((<a class="code" href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a> *)&amp;_SlFsOpenCmdCtrl, &amp;Msg, &amp;CmdExt);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    FileHandle = (_i32)Msg.Rsp.FileHandle;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    if (pToken != NULL)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        *pToken =      Msg.Rsp.Token;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">/* in case of an error, return the erros file handler as an error code */</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">return</span> FileHandle;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div><div class="ttc" id="struct___sl_cmd_ctrl__t_html"><div class="ttname"><a href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00210">driver.h:210</a></div></div>
<div class="ttc" id="struct___sl_cmd_ext__t_html"><div class="ttname"><a href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00217">driver.h:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga726fe9fb226af88bc504996e2a59a246"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga726fe9fb226af88bc504996e2a59a246">&sect;&nbsp;</a></span>sl_FsProgram()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_i32 sl_FsProgram </td>
          <td>(</td>
          <td class="paramtype">const _u8 *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u16&#160;</td>
          <td class="paramname"><em>Len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _u8 *&#160;</td>
          <td class="paramname"><em>pKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u32&#160;</td>
          <td class="paramname"><em>Flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables to format and configure the device with pre-prepared configuration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Flags</td><td>For future use </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pKey</td><td>In case the ucf is encrypted the encryption key, otherwise NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pData</td><td>The file is download in data chunks, the chunk size should be aligned to 16 bytes, if no data Set to NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Len</td><td>The length of pData in bytes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The return value is:<ul>
<li>On error &lt; 0 , contains the error number and extended error number</li>
<li>On success &gt; 0, represent the number of bytes received</li>
<li>On successful end == 0 , when all file chunks are download </li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>belongs to ext_api </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd></dd></dl>
<dl class="section user"><dt>Example </dt><dd></dd></dl>
<ul>
<li>FS programming: <div class="fragment"><div class="line"><span class="comment">//Return 0 for OK, else Error</span></div><div class="line">_i32 ProgramImage( <span class="keywordtype">char</span>* UcfFileName, <span class="keywordtype">char</span> * KeyFileName )</div><div class="line">{</div><div class="line"><span class="preprocessor">    #define PROGRAMMING_CHUNK_SIZE 4096</span></div><div class="line">    _i32 slRetVal = 0;</div><div class="line">    <a class="code" href="group___file_system.html#struct_sl_fs_key__t">SlFsKey_t</a> Key;</div><div class="line">    FILE *hostFileHandle = NULL;</div><div class="line">    _u16 bytesRead;</div><div class="line">    _u8 DataBuf[PROGRAMMING_CHUNK_SIZE];</div><div class="line">    FILE *KeyFileHandle = NULL;</div><div class="line">    <span class="keywordtype">short</span> ErrorNum;</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ExtendedErrorNum;</div><div class="line">    time_t start,end;</div><div class="line">    <span class="keywordtype">double</span> dif;</div><div class="line">    _u8* pKey = NULL;</div><div class="line">    errno_t err;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (KeyFileName != <span class="stringliteral">&quot;&quot;</span>)</div><div class="line">    {</div><div class="line">        <span class="comment">//Read key</span></div><div class="line">        err   = fopen_s( &amp;KeyFileHandle, KeyFileName, <span class="stringliteral">&quot;rb&quot;</span>);</div><div class="line">        <span class="keywordflow">if</span> (err != 0)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">return</span> __LINE__;<span class="comment">//error</span></div><div class="line">        }</div><div class="line">        fread((_u8*)&amp;Key, 1, <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_fs_key__t">SlFsKey_t</a>), KeyFileHandle);</div><div class="line">        fclose(KeyFileHandle);</div><div class="line">        pKey = (_u8*)&amp;Key;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// Downlaoding the Data with the key, the key can be set only in the first chunk,no need to download it with each chunk</span></div><div class="line">    <span class="keywordflow">if</span> (UcfFileName != <span class="stringliteral">&quot;&quot;</span>)</div><div class="line">    {</div><div class="line">        <span class="comment">//Read data</span></div><div class="line">         err   = fopen_s( &amp;hostFileHandle, UcfFileName, <span class="stringliteral">&quot;rb&quot;</span>);</div><div class="line">        <span class="keywordflow">if</span> (err != 0)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">return</span> __LINE__;<span class="comment">//error</span></div><div class="line">        }</div><div class="line"></div><div class="line">        time (&amp;start);</div><div class="line"></div><div class="line">        bytesRead = fread(DataBuf, 1, PROGRAMMING_CHUNK_SIZE, hostFileHandle);</div><div class="line"></div><div class="line">        <span class="keywordflow">while</span> ( bytesRead  )</div><div class="line">        {</div><div class="line">            slRetVal =  <a class="code" href="group___file_system.html#ga726fe9fb226af88bc504996e2a59a246">sl_FsProgram</a>( DataBuf , bytesRead , (_u8*)pKey,  0 );</div><div class="line">            <span class="keywordflow">if</span>(slRetVal ==  SL_API_ABORTED)<span class="comment">//timeout</span></div><div class="line">            {</div><div class="line">                <span class="keywordflow">return</span>( slRetVal );</div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (slRetVal &lt; 0 )<span class="comment">//error</span></div><div class="line">            {</div><div class="line">                ErrorNum = (long)slRetVal &gt;&gt; 16;</div><div class="line">                ExtendedErrorNum = (_u16)(slRetVal &amp; 0xFFFF);</div><div class="line">                printf(<span class="stringliteral">&quot;\tError sl_FsProgram = %d , %d \n&quot;</span>, ErrorNum, ExtendedErrorNum);</div><div class="line">                fclose(hostFileHandle);</div><div class="line">                <span class="keywordflow">return</span>( ErrorNum );</div><div class="line">            }</div><div class="line">            <span class="keywordflow">if</span>(slRetVal == 0)<span class="comment">//finished succesfully</span></div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            pKey = NULL;<span class="comment">//no need to download the key with each chunk;</span></div><div class="line">            bytesRead = fread(DataBuf, 1, PROGRAMMING_CHUNK_SIZE, hostFileHandle);</div><div class="line">        }</div><div class="line"></div><div class="line"></div><div class="line">        time (&amp;end);</div><div class="line">        dif = difftime (end,start);</div><div class="line"><span class="preprocessor">    #ifdef PRINT</span></div><div class="line">        printf (<span class="stringliteral">&quot;\tProgramming took %.2lf seconds to run.\n&quot;</span>, dif );</div><div class="line"><span class="preprocessor">    #endif</span></div><div class="line">        <span class="comment">//The file was downloaded but it was not detected by the programming as the EOF.</span></div><div class="line">        <span class="keywordflow">if</span>((bytesRead == 0 ) &amp;&amp; (slRetVal &gt; 0 ))</div><div class="line">        {</div><div class="line">            <span class="keywordflow">return</span> __LINE__;<span class="comment">//error</span></div><div class="line">        }</div><div class="line"></div><div class="line"></div><div class="line">        fclose(hostFileHandle);</div><div class="line">    }<span class="comment">//if (UcfFileName != &quot;&quot;)</span></div><div class="line"></div><div class="line">    <span class="comment">//this scenario is in case the image was already &quot;burned&quot; to the SFLASH by external tool and only the key is downloaded</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (KeyFileName != <span class="stringliteral">&quot;&quot;</span>)</div><div class="line">    {</div><div class="line">        slRetVal =  <a class="code" href="group___file_system.html#ga726fe9fb226af88bc504996e2a59a246">sl_FsProgram</a>(NULL , 0 , (_u8*)pKey,  0 );</div><div class="line">        <span class="keywordflow">if</span> (slRetVal &lt; 0)<span class="comment">//error</span></div><div class="line">        {</div><div class="line">            ErrorNum = (long)slRetVal &gt;&gt; 16;</div><div class="line">            ExtendedErrorNum = (_u16)slRetVal &amp;&amp; 0xFF;;</div><div class="line">            printf(<span class="stringliteral">&quot;\tError sl_FsProgram = %d , %d \n&quot;</span>, ErrorNum, ExtendedErrorNum);</div><div class="line">            fclose(hostFileHandle);</div><div class="line">            <span class="keywordflow">return</span>( ErrorNum );</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>( slRetVal == 0 )</div><div class="line">    {</div><div class="line">        <span class="comment">//Reset the nWP</span></div><div class="line">        <a class="code" href="group___device.html#gafe7d6e18cd17c10e1b2d9793af56df13">sl_Stop</a>(100);</div><div class="line">        Sleep(1000);</div><div class="line">        <a class="code" href="group___device.html#ga5869df658d2c9fe3c2baa50503a1a8dd">sl_Start</a>(NULL, NULL, NULL);</div><div class="line">        Sleep(2000);</div><div class="line">     }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> slRetVal;</div><div class="line"></div><div class="line">}</div></div><!-- fragment --> </li>
</ul>

<p>Definition at line <a class="el" href="fs_8c_source.html#l00689">689</a> of file <a class="el" href="fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;{</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    _SlFsProgrammingMsg_u     Msg;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>               CmdExt;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    _u16                      ChunkLen;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    VERIFY_API_ALLOWED(SL_OPCODE_SILO_FS);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    Msg.Cmd.Flags = (_u32)Flags;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   _SlDrvResetCmdExt(&amp;CmdExt);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">/* no data and no key, called only for extracting the image */</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">if</span>( (DataLen == 0) &amp;&amp; (pKey == NULL) )</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    {</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        Msg.Cmd.ChunkLen = 0;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        Msg.Cmd.KeyLen = 0;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        Msg.Cmd.Flags = Flags;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        VERIFY_RET_OK(_SlDrvCmdOp((<a class="code" href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a> *)&amp;_SlFsProgrammingCmdCtrl, &amp;Msg, &amp;CmdExt));</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (DataLen&gt; 0)  &amp;&amp; ( pData == NULL))</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;       <span class="keywordflow">return</span> (SL_ERROR_FS_WRONG_INPUT_SIZE_INTERNAL_SHIFTED_16_LEFT);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (DataLen == 0) &amp;&amp; (pKey != NULL) )</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        Msg.Cmd.ChunkLen = 0;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        Msg.Cmd.KeyLen = <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_fs_key__t">SlFsKey_t</a>);;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        Msg.Cmd.Flags = Flags;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        CmdExt.pTxPayload1 = (_u8*)pKey;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        CmdExt.TxPayload1Len  = <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_fs_key__t">SlFsKey_t</a>);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        VERIFY_RET_OK(_SlDrvCmdOp((<a class="code" href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a> *)&amp;_SlFsProgrammingCmdCtrl, &amp;Msg, &amp;CmdExt));</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">else</span> <span class="comment">/* DataLen &gt; 0 */</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">if</span>( (DataLen &amp; 0xF) &gt; 0)</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="keywordflow">return</span> (SL_ERROR_FS_NOT_16_ALIGNED_INTERNAL_SHIFTED_16_LEFT);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        }</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        Msg.Cmd.Flags = Flags;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        CmdExt.pTxPayload1 = (_u8 *)pData;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        ChunkLen = (_u16)sl_min(MAX_NVMEM_CHUNK_SIZE, DataLen);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">while</span>(ChunkLen &gt; 0)</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            Msg.Cmd.ChunkLen  = ChunkLen;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            CmdExt.TxPayload1Len = ChunkLen;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="keywordflow">if</span>( pKey != NULL )</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                Msg.Cmd.KeyLen = <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_fs_key__t">SlFsKey_t</a>);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                CmdExt.RxPayloadLen = <span class="keyword">sizeof</span>(<a class="code" href="group___file_system.html#struct_sl_fs_key__t">SlFsKey_t</a>);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                CmdExt.pRxPayload = (_u8 *)pKey;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="keywordflow">if</span>(CmdExt.pRxPayload != NULL &amp;&amp;  CmdExt.RxPayloadLen != 0)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    CmdExt.RxPayloadLen = CmdExt.RxPayloadLen * (-1);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keywordflow">else</span> <span class="comment">/* No key */</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            {</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                Msg.Cmd.KeyLen = 0;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                CmdExt.RxPayloadLen = 0;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                CmdExt.pRxPayload   = NULL;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            VERIFY_RET_OK( _SlDrvCmdOp((<a class="code" href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a> *)&amp;_SlFsProgrammingCmdCtrl, &amp;Msg, &amp;CmdExt));</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="keywordflow">if</span>( Msg.Rsp.Status &lt;= 0 ) <span class="comment">/* Error or finished */</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                <span class="keywordflow">return</span> (_i32)(Msg.Rsp.Status);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            DataLen -= ChunkLen;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            CmdExt.pTxPayload1 += ChunkLen;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            ChunkLen = (_u16)sl_min(MAX_NVMEM_CHUNK_SIZE, DataLen);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        }</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    }</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">return</span>  (_i32)(Msg.Rsp.Status);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;}</div><div class="ttc" id="struct___sl_cmd_ctrl__t_html"><div class="ttname"><a href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00210">driver.h:210</a></div></div>
<div class="ttc" id="struct___sl_cmd_ext__t_html"><div class="ttname"><a href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00217">driver.h:217</a></div></div>
<div class="ttc" id="group___file_system_html_struct_sl_fs_key__t"><div class="ttname"><a href="group___file_system.html#struct_sl_fs_key__t">SlFsKey_t</a></div><div class="ttdef"><b>Definition:</b> <a href="fs_8h_source.html#l00175">fs.h:175</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga745742b9829a05e2a502efa054f4900c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga745742b9829a05e2a502efa054f4900c">&sect;&nbsp;</a></span>sl_FsRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_i32 sl_FsRead </td>
          <td>(</td>
          <td class="paramtype">const _i32&#160;</td>
          <td class="paramname"><em>FileHdl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u32&#160;</td>
          <td class="paramname"><em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u8 *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u32&#160;</td>
          <td class="paramname"><em>Len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read block of data from a file in storage device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">FileHdl</td><td>Pointer to the file (assigned from sl_FsOpen) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Offset</td><td>Offset to specific read block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pData</td><td>Pointer for the received data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Len</td><td>Length of the received data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of read bytes on success, negative error code on failure</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group___file_system.html#ga12caded07ff4c66e5b6e73a36009072d" title="Close file in storage device. ">sl_FsClose</a> <a class="el" href="group___file_system.html#ga23d68a0f564436b6ef08325b1a159e85" title="Write block of data to a file in storage device. ">sl_FsWrite</a> <a class="el" href="group___file_system.html#ga16186e069ba1bcdc6eef2ab589a42a78" title="open file for read or write from/to storage device ">sl_FsOpen</a> </dd></dl>
<dl class="section note"><dt>Note</dt><dd>belongs to basic_api </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd></dd></dl>
<dl class="section user"><dt>Example</dt><dd></dd></dl>
<ul>
<li>Reading File: <div class="fragment"><div class="line">Status = <a class="code" href="group___file_system.html#ga745742b9829a05e2a502efa054f4900c">sl_FsRead</a>(FileHandle, 0, &amp;readBuff[0], readSize);</div></div><!-- fragment --> </li>
</ul>

<p>Definition at line <a class="el" href="fs_8c_source.html#l00305">305</a> of file <a class="el" href="fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;{</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    _SlFsReadMsg_u      Msg;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>         ExtCtrl;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    _u16                ChunkLen;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    _SlReturnVal_t      RetVal =0;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    _i32                RetCount = 0;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">/* verify that this api is allowed. if not allowed then</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">    ignore the API execution and return immediately with an error */</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    VERIFY_API_ALLOWED(SL_OPCODE_SILO_FS);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    _SlDrvMemZero(&amp;ExtCtrl, (_u16)<span class="keyword">sizeof</span>(<a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>));</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    ChunkLen             = (_u16)sl_min(MAX_NVMEM_CHUNK_SIZE,Len);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    ExtCtrl.RxPayloadLen = (_i16)ChunkLen;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    ExtCtrl.pRxPayload   = (_u8 *)(pData);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    Msg.Cmd.Offset       = Offset;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    Msg.Cmd.Len          = ChunkLen;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    Msg.Cmd.FileHandle   = (_u32)FileHdl;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        RetVal = _SlDrvCmdOp((<a class="code" href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a> *)&amp;_SlFsReadCmdCtrl, &amp;Msg, &amp;ExtCtrl);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">if</span>(SL_OS_RET_CODE_OK == RetVal)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keywordflow">if</span>( Msg.Rsp.status &lt; 0)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <span class="keywordflow">if</span>( RetCount &gt; 0)</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                   <span class="keywordflow">return</span> RetCount;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                   <span class="keywordflow">return</span> Msg.Rsp.status;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            RetCount += (_i32)Msg.Rsp.status;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            Len -= ChunkLen;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            Offset += ChunkLen;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            Msg.Cmd.Offset = Offset;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            ExtCtrl.pRxPayload += ChunkLen;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            ChunkLen = (_u16)sl_min(MAX_NVMEM_CHUNK_SIZE,Len);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            ExtCtrl.RxPayloadLen  = (_i16)ChunkLen;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            Msg.Cmd.Len = ChunkLen;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            Msg.Cmd.FileHandle = (_u32)FileHdl;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">return</span> RetVal;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }<span class="keywordflow">while</span>(ChunkLen &gt; 0);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">return</span> (_i32)RetCount;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div><div class="ttc" id="struct___sl_cmd_ctrl__t_html"><div class="ttname"><a href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00210">driver.h:210</a></div></div>
<div class="ttc" id="struct___sl_cmd_ext__t_html"><div class="ttname"><a href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00217">driver.h:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga23d68a0f564436b6ef08325b1a159e85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga23d68a0f564436b6ef08325b1a159e85">&sect;&nbsp;</a></span>sl_FsWrite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_i32 sl_FsWrite </td>
          <td>(</td>
          <td class="paramtype">const _i32&#160;</td>
          <td class="paramname"><em>FileHdl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u32&#160;</td>
          <td class="paramname"><em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u8 *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_u32&#160;</td>
          <td class="paramname"><em>Len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write block of data to a file in storage device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">FileHdl</td><td>Pointer to the file (assigned from sl_FsOpen) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Offset</td><td>Offset to specific block to be written </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pData</td><td>Pointer the transmitted data to the storage device </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Len</td><td>Length of the transmitted data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of wireted bytes on success, negative error code on failure</dd></dl>
<dl class="section see"><dt>See also</dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>belongs to basic_api </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd></dd></dl>
<dl class="section user"><dt>Example</dt><dd></dd></dl>
<ul>
<li>Writing file: <div class="fragment"><div class="line">Status = <a class="code" href="group___file_system.html#ga23d68a0f564436b6ef08325b1a159e85">sl_FsWrite</a>(FileHandle, 0, &amp;buff[0], readSize);</div></div><!-- fragment --> </li>
</ul>

<p>Definition at line <a class="el" href="fs_8c_source.html#l00379">379</a> of file <a class="el" href="fs_8c_source.html">fs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;{</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    _SlFsWriteMsg_u     Msg;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>         ExtCtrl;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    _u16                ChunkLen;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    _SlReturnVal_t      RetVal;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    _i32                RetCount = 0;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">/* verify that this api is allowed. if not allowed then</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">    ignore the API execution and return immediately with an error */</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    VERIFY_API_ALLOWED(SL_OPCODE_SILO_FS);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    _SlDrvMemZero(&amp;ExtCtrl, (_u16)<span class="keyword">sizeof</span>(<a class="code" href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a>));</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    ChunkLen              = (_u16)sl_min(MAX_NVMEM_CHUNK_SIZE,Len);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    ExtCtrl.TxPayload1Len = ChunkLen;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    ExtCtrl.pTxPayload1   = (_u8 *)(pData);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    Msg.Cmd.Offset        = Offset;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    Msg.Cmd.Len           = ChunkLen;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    Msg.Cmd.FileHandle    = (_u32)FileHdl;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        RetVal = _SlDrvCmdOp((<a class="code" href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a> *)&amp;_SlFsWriteCmdCtrl, &amp;Msg, &amp;ExtCtrl);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">if</span>(SL_OS_RET_CODE_OK == RetVal)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">if</span>( Msg.Rsp.status &lt; 0)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <span class="keywordflow">if</span>( RetCount &gt; 0)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    <span class="keywordflow">return</span> RetCount;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    <span class="keywordflow">return</span> Msg.Rsp.status;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            RetCount += (_i32)Msg.Rsp.status;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            Len -= ChunkLen;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            Offset += ChunkLen;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            Msg.Cmd.Offset = Offset;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            ExtCtrl.pTxPayload1 += ChunkLen;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            ChunkLen = (_u16)sl_min(MAX_NVMEM_CHUNK_SIZE,Len);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            ExtCtrl.TxPayload1Len  = ChunkLen;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            Msg.Cmd.Len = ChunkLen;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            Msg.Cmd.FileHandle = (_u32)FileHdl;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordflow">return</span> RetVal;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }<span class="keywordflow">while</span>(ChunkLen &gt; 0);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">return</span> (_i32)RetCount;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div><div class="ttc" id="struct___sl_cmd_ctrl__t_html"><div class="ttname"><a href="struct___sl_cmd_ctrl__t.html">_SlCmdCtrl_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00210">driver.h:210</a></div></div>
<div class="ttc" id="struct___sl_cmd_ext__t_html"><div class="ttname"><a href="struct___sl_cmd_ext__t.html">_SlCmdExt_t</a></div><div class="ttdef"><b>Definition:</b> <a href="driver_8h_source.html#l00217">driver.h:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="struct_sl_fs_file_info__t" id="struct_sl_fs_file_info__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_sl_fs_file_info__t">&sect;&nbsp;</a></span>SlFsFileInfo_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SlFsFileInfo_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="fs_8h_source.html#l00142">142</a> of file <a class="el" href="fs_8h_source.html">fs.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a522ea323663b801ea1e2988946e38ccf"></a>_u16</td>
<td class="fieldname">
Flags</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ada589d3671359f24a8c38db4f8a227f6"></a>_u32</td>
<td class="fieldname">
Len</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a17c093a3f1bbae5e67a8692f710de53d"></a>_u32</td>
<td class="fieldname">
MaxSize</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a981e85997aac96ab60b266088a11665b"></a>_u32</td>
<td class="fieldname">
StorageSize</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abdf1173d4d93434f8a910e0f84987463"></a>_u32</td>
<td class="fieldname">
Token[4]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a58d40483eb08b27f5126ca072b9ba756"></a>_u32</td>
<td class="fieldname">
WriteCounter</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="struct_sl_fs_key__t" id="struct_sl_fs_key__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_sl_fs_key__t">&sect;&nbsp;</a></span>SlFsKey_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SlFsKey_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="fs_8h_source.html#l00175">175</a> of file <a class="el" href="fs_8h_source.html">fs.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ad0155d24ecd7700b76095d7c6e337dd6"></a>_u32</td>
<td class="fieldname">
Key[4]</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="struct_sl_fs_file_name_index__t" id="struct_sl_fs_file_name_index__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_sl_fs_file_name_index__t">&sect;&nbsp;</a></span>SlFsFileNameIndex_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SlFsFileNameIndex_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="fs_8h_source.html#l00180">180</a> of file <a class="el" href="fs_8h_source.html">fs.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a4aabef62c50245f5015caa15961c5aa6"></a>_u8</td>
<td class="fieldname">
Index</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="union_sl_fs_file_name_index_or_error__t" id="union_sl_fs_file_name_index_or_error__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#union_sl_fs_file_name_index_or_error__t">&sect;&nbsp;</a></span>SlFsFileNameIndexOrError_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">union SlFsFileNameIndexOrError_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="fs_8h_source.html#l00185">185</a> of file <a class="el" href="fs_8h_source.html">fs.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="aa07f44a28e90ab1262a99479364f1ecb"></a>_i32</td>
<td class="fieldname">
ErrorNumber</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7a1b55a27eb95e6e56cfb76cd1d46c58"></a><a class="el" href="group___file_system.html#struct_sl_fs_file_name_index__t">SlFsFileNameIndex_t</a></td>
<td class="fieldname">
Index</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="struct_sl_fs_ret_to_factory_command__t" id="struct_sl_fs_ret_to_factory_command__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_sl_fs_ret_to_factory_command__t">&sect;&nbsp;</a></span>SlFsRetToFactoryCommand_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SlFsRetToFactoryCommand_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="fs_8h_source.html#l00200">200</a> of file <a class="el" href="fs_8h_source.html">fs.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="af2b29ec8cbb14f441a279b690421b6df"></a>_u32</td>
<td class="fieldname">
Operation</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="struct_sl_fs_control__t" id="struct_sl_fs_control__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_sl_fs_control__t">&sect;&nbsp;</a></span>SlFsControl_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SlFsControl_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="fs_8h_source.html#l00207">207</a> of file <a class="el" href="fs_8h_source.html">fs.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a59f2eec4d560ca61c0a233bdc74530f7"></a>_u32</td>
<td class="fieldname">
IncludeFilters</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="struct_sl_fs_control_device_usage__t" id="struct_sl_fs_control_device_usage__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_sl_fs_control_device_usage__t">&sect;&nbsp;</a></span>SlFsControlDeviceUsage_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SlFsControlDeviceUsage_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="fs_8h_source.html#l00213">213</a> of file <a class="el" href="fs_8h_source.html">fs.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a0c1540ac281d51c1cb245a7b833909c4"></a>_u16</td>
<td class="fieldname">
DeviceBlocksCapacity</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad38568081195aa5d530f81db6c1cecf8"></a>_u16</td>
<td class="fieldname">
DeviceBlockSize</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a545ca8175b682d0da8fd77741f1ac0cc"></a>_u16</td>
<td class="fieldname">
LargestAllocatedGapInBlocks</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="afbe89f5cba628627aa56d2d5ff29a1bf"></a>_u16</td>
<td class="fieldname">
NumOfAllocatedBlocks</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0b480e07b65a3a55b477211a77db1011"></a>_u16</td>
<td class="fieldname">
NumOfAvailableBlocksForUserFiles</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a41fb779703965616ebe08d3e45988302"></a>_u16</td>
<td class="fieldname">
NumOfReservedBlocks</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6c5ecc66c0d2379eab16719ee4d311bd"></a>_u16</td>
<td class="fieldname">
NumOfReservedBlocksForSystemfiles</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7b31ced7e468b57e02cd3b78db2cbef5"></a>_u8</td>
<td class="fieldname">
Padding[2]</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="struct_sl_fs_control_files_usage__t" id="struct_sl_fs_control_files_usage__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_sl_fs_control_files_usage__t">&sect;&nbsp;</a></span>SlFsControlFilesUsage_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SlFsControlFilesUsage_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="fs_8h_source.html#l00225">225</a> of file <a class="el" href="fs_8h_source.html">fs.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="aa73d5b1f01a5ba0b4b4cb6dafcf1e25c"></a>_u8</td>
<td class="fieldname">
ActualNumOfSysFiles</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a969fe021726970d8ff4a085a03549985"></a>_u8</td>
<td class="fieldname">
ActualNumOfUserFiles</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7ab76189a30debf3dfa5b7ff5cc8b8f3"></a>_u8</td>
<td class="fieldname">
Bundlestate</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a025d64be1e5b3a8f79f222d128877e30"></a>_u16</td>
<td class="fieldname">
FATWriteCounter</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1ca40d2eca10753b4753ae4e7ce61b8c"></a>_u8</td>
<td class="fieldname">
IsDevlopmentFormatType</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a02c1f11dfbb3d368df31443c4add1f47"></a>_u8</td>
<td class="fieldname">
MaxFsFiles</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a171ec15feafa6857b3cbe0239a4d1c28"></a>_u8</td>
<td class="fieldname">
MaxFsFilesReservedForSysFiles</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7072a9c20a982eeb9b7272aa6365fae1"></a>_u32</td>
<td class="fieldname">
NumOfAlerts</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a17e8fd8c1501cd98370c51f2368a555d"></a>_u32</td>
<td class="fieldname">
NumOfAlertsThreshold</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abfe28724ad150292705a0bf83b093b8e"></a>_u8</td>
<td class="fieldname">
Padding</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="adab134b145f6a876db833b07f7a02d0e"></a>_u16</td>
<td class="fieldname">
Padding2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2f1a76867fe7184d36fd5090caec3305"></a>_u8</td>
<td class="fieldname">
Reserved</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="struct_sl_fs_control_get_storage_info_response__t" id="struct_sl_fs_control_get_storage_info_response__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_sl_fs_control_get_storage_info_response__t">&sect;&nbsp;</a></span>SlFsControlGetStorageInfoResponse_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SlFsControlGetStorageInfoResponse_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="fs_8h_source.html#l00242">242</a> of file <a class="el" href="fs_8h_source.html">fs.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="abca1d0e32f6787b4010da51485e06a7f"></a><a class="el" href="group___file_system.html#struct_sl_fs_control_device_usage__t">SlFsControlDeviceUsage_t</a></td>
<td class="fieldname">
DeviceUsage</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae1bb615247cb7a401c81674ecd01ef70"></a><a class="el" href="group___file_system.html#struct_sl_fs_control_files_usage__t">SlFsControlFilesUsage_t</a></td>
<td class="fieldname">
FilesUsage</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="struct_sl_fs_control_get_counters_response__t" id="struct_sl_fs_control_get_counters_response__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_sl_fs_control_get_counters_response__t">&sect;&nbsp;</a></span>SlFsControlGetCountersResponse_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SlFsControlGetCountersResponse_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="fs_8h_source.html#l00248">248</a> of file <a class="el" href="fs_8h_source.html">fs.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ae312d038bd12666ff8d411d4ba5bd194"></a>_u8</td>
<td class="fieldname">
ClosedFilesCnt</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aadf19600abdcdd3024838932e065f866"></a>_u8</td>
<td class="fieldname">
ClosedFilesCntWithValidFailSafeImage</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a59f2eec4d560ca61c0a233bdc74530f7"></a>_u32</td>
<td class="fieldname">
IncludeFilters</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5b82c42262e61786ded7d6f7c6c8ee8a"></a>_u8</td>
<td class="fieldname">
OpenedForWriteCnt</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a73a0d199d74cbb2be6aa523b7a3ff99c"></a>_u8</td>
<td class="fieldname">
OpenedForWriteCntWithValidFailSafeImage</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1636b7c505491b24ab8bcec41293e350"></a>_u8</td>
<td class="fieldname">
OpeneForReadCnt</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae513859fc1c5287e17f5133ccdc8fc0d"></a>_u8</td>
<td class="fieldname">
OpeneForReadCntWithValidFailSafeImage</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a591a340cf7a3bc8395dc554fc01910b7"></a>_u8</td>
<td class="fieldname">
padding[2]</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="struct_sl_file_attributes__t" id="struct_sl_file_attributes__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_sl_file_attributes__t">&sect;&nbsp;</a></span>SlFileAttributes_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SlFileAttributes_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock">
<p>Definition at line <a class="el" href="fs_8h_source.html#l00271">271</a> of file <a class="el" href="fs_8h_source.html">fs.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a893bba386374834a41e7483a1ac01791"></a>_u32</td>
<td class="fieldname">
FileAllocatedBlocks</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a652d6d1cc86e171042f64a21f0ed91f7"></a>_u32</td>
<td class="fieldname">
FileMaxSize</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab84dd5b77be3cdbb84cdc0496aff753b"></a>_u32</td>
<td class="fieldname">
Properties</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
